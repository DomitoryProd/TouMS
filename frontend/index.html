<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TuD</title>
</head>
<body>
    <style>*{font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;}</style>
    <h1>TUD</h1>
    <p>Matches in here</p>
    <input type="text" id="main" placeholder="Write to send">
    <button id="send-participant">Add Participant</button>
    <div class="score">
        Score CT side
        <p id="scorect">0</p>
    </div>
    <div class="score">
        Score T side
        <p id="scoret">0</p>
    </div>
    <style>
        .score {
            border-radius: 12px;
            background-color: #000;
            color: #fff;
            padding: 12px;
            margin: 12px;
        }
    </style>

    <script>
        const ws = new WebSocket("ws://localhost:5671");
        const inp = document.getElementById("main");
        const btn = document.getElementById("send-participant");

        btn.addEventListener("click", () => {
            const data = {
                type: "add_participant",
                name: inp.value.trim()
            };
            ws.send(JSON.stringify(data)); // ðŸ‘ˆ This is the important part
            inp.value = ""; // clear the input
        });

        ws.addEventListener("open", () => {
            console.log("connection is established");
        });
        
        
        ws.addEventListener("message", (e) => {
            let data = JSON.parse(e.data);
            console.log("Server says:", data);
            console.log(data.scores.ct);
            if (data.type === "update_scores") {
                console.log("update_scores");
                document.getElementById("scorect").innerHTML = data.scores.ct;
                document.getElementById("scoret").innerHTML = data.scores.t;
            }
            // let data = JSON.parse(e.data);
            // if (data) {

            //     document.getElementById("scorect").textContent = data.scorect;
            //     document.getElementById("scoret").textContent = data.scoret;
            // }
            
        });
    </script>
</body>
</html>